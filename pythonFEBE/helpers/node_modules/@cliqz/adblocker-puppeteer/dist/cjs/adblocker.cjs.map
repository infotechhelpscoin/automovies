{"version":3,"file":"adblocker.cjs","sources":["../src/adblocker.js"],"sourcesContent":["/*!\n * Copyright (c) 2017-present Cliqz GmbH. All rights reserved.\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { parse } from 'tldts-experimental';\nimport { FiltersEngine, Request } from '@cliqz/adblocker';\nimport { autoRemoveScript, extractFeaturesFromDOM, DOMMonitor } from '@cliqz/adblocker-content';\nfunction sleep(milliseconds) {\n    return new Promise((resolve) => {\n        setTimeout(resolve, milliseconds);\n    });\n}\nfunction getTopLevelUrl(frame) {\n    let sourceUrl = '';\n    while (frame !== null) {\n        sourceUrl = frame.url();\n        if (sourceUrl.length !== 0) {\n            break;\n        }\n        frame = frame.parentFrame();\n    }\n    return sourceUrl;\n}\n/**\n * Create an instance of `Request` from `puppeteer.Request`.\n */\nexport function fromPuppeteerDetails(details) {\n    const sourceUrl = getTopLevelUrl(details.frame());\n    const url = details.url();\n    const type = details.resourceType();\n    return Request.fromRawDetails({\n        _originalRequestDetails: details,\n        requestId: `${type}-${url}-${sourceUrl}`,\n        sourceUrl,\n        type,\n        url,\n    });\n}\n/**\n * Wrap `FiltersEngine` into a Puppeteer-friendly helper class.\n */\nexport class BlockingContext {\n    constructor(page, blocker) {\n        this.page = page;\n        this.blocker = blocker;\n        this.onFrameNavigated = (frame) => blocker.onFrameNavigated(frame);\n        this.onDomContentLoaded = () => blocker.onFrameNavigated(this.page.mainFrame());\n        this.onRequest = (request) => blocker.onRequest(request);\n    }\n    async enable() {\n        if (this.blocker.config.loadCosmeticFilters) {\n            // Register callbacks to cosmetics injection (CSS + scriptlets)\n            this.page.on('frameattached', this.onFrameNavigated);\n            this.page.on('domcontentloaded', this.onDomContentLoaded);\n        }\n        if (this.blocker.config.loadNetworkFilters) {\n            // Make sure request interception is enabled for `page` before proceeding\n            await this.page.setRequestInterception(true);\n            // NOTES:\n            //  - page.setBypassCSP(enabled) might be needed to perform\n            //  injections on some pages.\n            //  - we currently do not perform CSP headers injection as there is\n            //  currently no way to modify responses in puppeteer. This feature could\n            //  easily be added if puppeteer implements the required capability.\n            //\n            // Register callback for network requests filtering.\n            this.page.on('request', this.onRequest);\n        }\n    }\n    async disable() {\n        if (this.blocker.config.loadNetworkFilters) {\n            this.page.off('request', this.onRequest);\n            await this.page.setRequestInterception(false);\n        }\n        if (this.blocker.config.loadCosmeticFilters) {\n            this.page.off('frameattached', this.onFrameNavigated);\n            this.page.off('domcontentloaded', this.onDomContentLoaded);\n        }\n    }\n}\n/**\n * Wrap `FiltersEngine` into a Puppeteer-friendly helper class. It exposes\n * methods to interface with Puppeteer APIs needed to block ads.\n */\nexport class PuppeteerBlocker extends FiltersEngine {\n    constructor() {\n        super(...arguments);\n        this.contexts = new WeakMap();\n        // Defaults to undefined which preserves Legacy Mode behavior\n        this.priority = undefined;\n        // ----------------------------------------------------------------------- //\n        // PuppeteerBlocker-specific additions to FiltersEngine\n        // ----------------------------------------------------------------------- //\n        this.onFrameNavigated = async (frame) => {\n            try {\n                await this.onFrame(frame);\n            }\n            catch (ex) {\n                // Ignore\n            }\n        };\n        this.onFrame = async (frame) => {\n            const url = frame.url();\n            if (url === 'chrome-error://chromewebdata/') {\n                return;\n            }\n            // Look for all iframes in this context and check if they should be removed\n            // from the DOM completely. For this we check if their `src` or `href`\n            // attribute would be blocked by any network filter.\n            this.removeBlockedFrames(frame).catch(() => {\n                /* ignore */\n            });\n            const parsed = parse(url);\n            const hostname = parsed.hostname || '';\n            const domain = parsed.domain || '';\n            // We first query for stylesheets and scriptlets which are either generic or\n            // based on the hostname of this frame. We need to get these as fast as\n            // possible to reduce blinking when page loads.\n            {\n                // TODO - implement extended filters for Puppeteer\n                const { active, styles, scripts /* , extended */ } = this.getCosmeticsFilters({\n                    domain,\n                    hostname,\n                    url,\n                    // Done once per frame.\n                    getBaseRules: true,\n                    getInjectionRules: true,\n                    getExtendedRules: true,\n                    getRulesFromHostname: true,\n                    // Will handle DOM features (see below).\n                    getRulesFromDOM: false,\n                });\n                if (active === false) {\n                    return;\n                }\n                Promise.all([\n                    this.injectScriptletsIntoFrame(frame, scripts),\n                    this.injectStylesIntoFrame(frame, styles),\n                ]).catch(() => {\n                    /* ignore */\n                });\n            }\n            // Seconde step is to start monitoring the DOM of the page in order to\n            // inject more specific selectors based on `id`, `class`, or `href` found on\n            // nodes. We first query all of them, then monitor the DOM for a few\n            // seconds (or until one of the stopping conditions is met, see below).\n            const observer = new DOMMonitor((update) => {\n                if (update.type === 'features') {\n                    const { active, styles } = this.getCosmeticsFilters(Object.assign(Object.assign({ domain,\n                        hostname,\n                        url }, update), { \n                        // Only done once per frame (see above).\n                        getBaseRules: false, getInjectionRules: false, getExtendedRules: false, getRulesFromHostname: false, \n                        // Allows to get styles for updated DOM.\n                        getRulesFromDOM: true }));\n                    // Abort if cosmetics are disabled\n                    if (active === false) {\n                        return;\n                    }\n                    this.injectStylesIntoFrame(frame, styles).catch(() => {\n                        /* ignore */\n                    });\n                }\n            });\n            // This loop will periodically check if any new custom styles should be\n            // injected in the page (using values of attributes `id`, `class`, or `href`).\n            //\n            // We stop looking in the following cases:\n            // * Frame was detached.\n            // * No new attribute was found.\n            // * Number of iterations exceeded 10 (i.e. 5 seconds).\n            // * Exception was raised.\n            //\n            // Additionally, we might stop after the first lookup if\n            // `enableMutationObserver` is disabled in config, which means that we\n            // should not actively monitor the DOM for changes.\n            let numberOfIterations = 0;\n            do {\n                if (frame.isDetached()) {\n                    break;\n                }\n                try {\n                    const foundNewFeatures = observer.handleNewFeatures(await frame.$$eval(':root', extractFeaturesFromDOM));\n                    numberOfIterations += 1;\n                    if (numberOfIterations === 10) {\n                        break;\n                    }\n                    if (foundNewFeatures === false) {\n                        break;\n                    }\n                }\n                catch (ex) {\n                    break;\n                }\n                if (this.config.enableMutationObserver === false) {\n                    break;\n                }\n                await sleep(500);\n                // eslint-disable-next-line no-constant-condition\n            } while (true);\n        };\n        this.setRequestInterceptionPriority = (defaultPriority = 0) => (this.priority = defaultPriority);\n        this.onRequest = (details) => {\n            var _a, _b, _c;\n            if ((_a = details.isInterceptResolutionHandled) === null || _a === void 0 ? void 0 : _a.call(details)) {\n                return;\n            }\n            const request = fromPuppeteerDetails(details);\n            if (this.config.guessRequestTypeFromUrl === true && request.type === 'other') {\n                request.guessTypeOfRequest();\n            }\n            const frame = details.frame();\n            if (request.isMainFrame() ||\n                (request.type === 'document' && frame !== null && frame.parentFrame() === null)) {\n                details.continue((_b = details.continueRequestOverrides) === null || _b === void 0 ? void 0 : _b.call(details), 0);\n                return;\n            }\n            const { redirect, match } = this.match(request);\n            if (redirect !== undefined) {\n                if (redirect.contentType.endsWith(';base64')) {\n                    details.respond({\n                        status: 200,\n                        headers: {},\n                        body: Buffer.from(redirect.body, 'base64'),\n                        contentType: redirect.contentType.slice(0, -7),\n                    }, this.priority);\n                }\n                else {\n                    details.respond({\n                        status: 200,\n                        headers: {},\n                        body: redirect.body,\n                        contentType: redirect.contentType,\n                    }, this.priority);\n                }\n            }\n            else if (match === true) {\n                details.abort('blockedbyclient', this.priority);\n            }\n            else {\n                details.continue((_c = details.continueRequestOverrides) === null || _c === void 0 ? void 0 : _c.call(details), 0);\n            }\n        };\n    }\n    // ----------------------------------------------------------------------- //\n    // Helpers to enable and disable blocking for 'browser'\n    // ----------------------------------------------------------------------- //\n    async enableBlockingInPage(page) {\n        let context = this.contexts.get(page);\n        if (context !== undefined) {\n            return context;\n        }\n        context = new BlockingContext(page, this);\n        this.contexts.set(page, context);\n        await context.enable();\n        return context;\n    }\n    async disableBlockingInPage(page) {\n        const context = this.contexts.get(page);\n        if (context === undefined) {\n            throw new Error('Trying to disable blocking which was not enabled');\n        }\n        this.contexts.delete(page);\n        await context.disable();\n    }\n    isBlockingEnabled(page) {\n        return this.contexts.has(page);\n    }\n    async injectStylesIntoFrame(frame, styles) {\n        if (styles.length !== 0) {\n            await frame.addStyleTag({\n                content: styles,\n            });\n        }\n    }\n    async injectScriptletsIntoFrame(frame, scripts) {\n        const promises = [];\n        if (scripts.length !== 0) {\n            for (let i = 0; i < scripts.length; i += 1) {\n                promises.push(frame\n                    .addScriptTag({\n                    content: autoRemoveScript(scripts[i]),\n                })\n                    .then(() => {\n                    /* Ignore result */\n                }));\n            }\n        }\n        await Promise.all(promises);\n    }\n    /**\n     * Look for sub-frames in `frame`, check if their `src` or `href` would be\n     * blocked, and then proceed to removing them from the DOM completely.\n     */\n    async removeBlockedFrames(frame) {\n        const promises = [];\n        const sourceUrl = getTopLevelUrl(frame);\n        for (const url of await frame.$$eval('iframe[src],iframe[href]', (elements) => elements.map(({ src, href }) => src || href))) {\n            const { match } = this.match(Request.fromRawDetails({\n                url,\n                sourceUrl,\n                type: 'sub_frame',\n            }));\n            if (match) {\n                promises.push(frame\n                    .$$eval(`iframe[src=\"${url}\"],iframe[href=\"${url}\"]`, (iframes) => {\n                    var _a;\n                    for (const iframe of iframes) {\n                        (_a = iframe === null || iframe === void 0 ? void 0 : iframe.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(iframe);\n                    }\n                })\n                    .catch(() => {\n                    /* ignore */\n                }));\n            }\n        }\n        await Promise.all(promises);\n    }\n}\n// Re-export symboles from @cliqz/adblocker for convenience\nexport * from '@cliqz/adblocker';\n//# sourceMappingURL=adblocker.js.map"],"names":["Request","FiltersEngine","parse","DOMMonitor","extractFeaturesFromDOM","autoRemoveScript"],"mappings":"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"}